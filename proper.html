<head>
  <title>proper</title>
</head>

<body>
  {{> page}}
</body>

<template name="page">
  <div class="container">
    <h1>PropeRoute</h1>

    {{> directionsForm}}

    <hr />

    {{> questions}}

    <hr />
    <button class="update-foursquare">Update Foursquare destinations</button>
  </div>
</template>

<template name="directionsForm">
  <div class="row">
    <div class="col-sm-6">
      <h3>Where are you headed?</h3>
      <div class="panel panel-default">
        <div class="panel-heading">From</div>

        <div class="panel-body">
          {{#if selectedFrom}}
            {{selectedFrom.name}}
            <button class="cancel-selection btn btn-xs btn-danger pull-right"
              data-type="from">Clear</button>
          {{else}}
            <input class="form-control" name="from" type="text" />
            <ul class="list-group">
              {{#each fromLandmarks}}
                <li class="list-group-item" data-id="{{_id}}" data-type="from">{{name}}</li>
              {{else}}
                Please type more than 2 characters
              {{/each}}
            </ul>
          {{/if}}
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">To</div>

        <div class="panel-body">
          {{#if selectedTo}}
            {{selectedTo.name}}
            <button class="cancel-selection btn btn-xs btn-danger pull-right"
              data-type="to">Clear</button>
          {{else}}
            <input class="form-control to" name="to" type="text" />

            <ul class="list-group">
              {{#each toLandmarks}}
                <li class="list-group-item" data-id="{{_id}}" data-type="to">
                  {{name}}
                </li>
              {{else}}
                Please type more than 2 characters
              {{/each}}
            </ul> 
          {{/if}}
        </div>
      </div>
    </div>

    <div class="col-sm-6">
      {{#if question}}
        {{#with question}}
          <div>
            <h2>Answers:</h2>
            {{#each answers}}
              <div class="panel panel-default">
                <div class="panel-body">

                  <p>{{{answerLandmarked}}}</p>
                  <button class="up btn btn-xs btn-default">Vote up</button>
                  <button class="down btn btn-xs btn-default">Vote down</button>
            
                  <div class="scoreBarDown">
                    <div class="scoreBarUp" style="width: {{percent}}%"></div>
                  </div>
                </div>
              </div>
            {{else}}
              <p>There haven't been any answers yet.</p>
            {{/each}}
          </div>
        {{/with}}
      {{else}}
        <h3>Post this question</h3>
        <p>This question hasn't been posted yet.</p>
        <button class="btn btn-lg btn-primary post-question">
          Post Question</button>
      {{/if}}
      
      <h3>Similar questions</h3>
        {{#each similarQuestions}}
          <div>
            {{fromLandmark.name}}
            <span class="glyphicon glyphicon-arrow-right"></span>
            {{toLandmark.name}}
          </div>
        {{else}}
          <div class="well">
            No similar questions found.
          </div>
        {{/each}}
    </div>
  </div>
</template>

<template name="questions">
  <h2>Recent Questions</h2>
  <div class="row">
    {{#each questions}}
      <div class="col-sm-7">
        <div class="panel panel-default">
          
          {{#if answeringThisQuestion}}
            <div class="panel-heading">
              {{fromLandmark.name}}
              <span class="glyphicon glyphicon-arrow-right"></span>
              {{toLandmark.name}}
            </div>
            <div class="panel-body">
              <div>
                <textarea class="answer-textarea" style="width: 100%"></textarea>
              </div>
              <div style="text-align: center">
                <button class="post-answer btn btn-sm btn-success">Post Answer</button>
                <button class="cancel-answering btn btn-sm btn-danger">Cancel</button>
              </div>
          </div>
          {{else}}
            <div class="panel-body">
              {{fromLandmark.name}}
              <span class="glyphicon glyphicon-arrow-right"></span>
              {{toLandmark.name}}
              <div class="pull-right">
                
                <button class="btn btn-xs btn-primary answer">Answer</button>
                <hr style="width=10px, size=5px">
                <span style="color:red">    {{answerCount}} answered    </span>
              </div>
            </div>
          {{/if}}
        </div>
      </div>
    {{/each}}
  </div>
</template>
