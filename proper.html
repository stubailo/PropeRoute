<head>
  <title>proper</title>
</head>

<body>
  {{> page}}
</body>

<template name="page">
  <div class="container">
    <h1>PropeRoute</h1>

    {{> directionsForm}}

    <hr />

    {{> questions}}

    <hr />
    <button class="update-foursquare">Update Foursquare destinations</button>
  </div>
</template>

<template name="directionsForm">
  <div class="row">
    <div class="col-sm-7">
      <h3>Where are you headed?</h3>

      <div class="row">
        <div class="col-sm-6">
          <div class="panel panel-default">
            <div class="panel-body">
              <strong>From:</strong>
              {{#if selectedFrom}}
                {{selectedFrom.name}}
                <button class="cancel-selection btn btn-xs btn-danger pull-right"
                  data-type="from">Clear</button>
              {{else}}
                <input class="form-control from" name="from" type="text" />
                <ul class="list-group popup">
                  {{#each fromLandmarks}}
                    <li class="list-group-item" data-id="{{_id}}" data-type="from">{{name}}</li>
                  {{/each}}
                </ul>
              {{/if}}
            </div>
          </div>
        </div>

        <div class="col-sm-6">
          <div class="panel panel-default">
            <div class="panel-body">
              <strong>To:</strong>
              {{#if selectedTo}}
                {{selectedTo.name}}
                <button class="cancel-selection btn btn-xs btn-danger pull-right"
                  data-type="to">Clear</button>
              {{else}}
                <input class="form-control to" name="to" type="text" />

                <ul class="list-group popup">
                  {{#each toLandmarks}}
                    <li class="list-group-item" data-id="{{_id}}" data-type="to">
                      {{name}}
                    </li>
                  {{/each}}
                </ul> 
              {{/if}}
            </div>
          </div>
        </div>
      </div>


      {{#if question}}
        {{#with question}}
          <div>
            <h3>Answers</h3>
            {{#each answers}}
              <div class="panel panel-default">
                <div class="panel-body">

                  <p>{{{answerLandmarked}}}</p>
                  <button class="up btn btn-xs btn-default">Vote up</button>
                  <button class="down btn btn-xs btn-default">Vote down</button>
            
                  <div class="scoreBarDown">
                    <div class="scoreBarUp" style="width: {{percent}}%"></div>
                  </div>
                </div>
              </div>
            {{else}}
              <p>There haven't been any answers yet.</p>
            {{/each}}
          </div>
        {{/with}}
      {{/if}}
      
      {{#if similarQuestions}}
        <h3>Similar questions</h3>
        {{#each similarQuestions}}
          <div>
            {{fromLandmark.name}}
            <span class="glyphicon glyphicon-arrow-right"></span>
            {{toLandmark.name}}
          </div>
        {{/each}}
      {{/if}}

      {{#unless question}}
        <button class="btn btn-lg btn-primary post-question">
          Post Question</button>
      {{/unless}}

    </div>

    <div class="col-sm-5">
      Map here
    </div>
  </div>
</template>

<template name="questions">
  <h2>Recent Questions</h2>
  <div class="row">
    {{#each questions}}
      <div class="col-sm-7">
        <div class="panel panel-default">
          
          {{#if answeringThisQuestion}}
            <div class="panel-heading">
              {{fromLandmark.name}}
              <span class="glyphicon glyphicon-arrow-right"></span>
              {{toLandmark.name}}
            </div>
            <div class="panel-body">
              <div>
                <textarea class="answer-textarea form-control"></textarea>
              </div>
              <div style="text-align: center">
                <button class="post-answer btn btn-sm btn-success">Post Answer</button>
                <button class="cancel-answering btn btn-sm btn-danger">Cancel</button>
              </div>
          </div>
          {{else}}
            <div class="panel-body">
              {{fromLandmark.name}}
              <span class="glyphicon glyphicon-arrow-right"></span>
              {{toLandmark.name}}
              <div class="pull-right">
                
                <button class="btn btn-xs btn-primary answer">Answer</button>
                <hr style="width=10px, size=5px">
                <span style="color:red">    {{answerCount}} answered    </span>
              </div>
            </div>
          {{/if}}
        </div>
      </div>
    {{/each}}
  </div>
</template>
